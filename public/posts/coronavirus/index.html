<!DOCTYPE html>

<html lang="en-us">
    <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="format-detection" content="telephone=no"/>

    <title>Zeyad Deeb</title>
    
    <link rel='icon' href='favicon.ico' type='image/x-icon'/>
    
    <meta name="theme-color" content="#ffffff">

    
    
    
    <link rel="stylesheet" href="https://www.zeyaddeeb.com/css/main.min.07a9cfa1a3a8999e9a21606064f4a147e568dd57c3010c09f068f6a9c274e9ca.css"/>

    
    
    

    
    
 
    
    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-76463767-1', 'auto');
	
	ga('send', 'pageview');
}
</script>

</head>
    <body>
        
<nav>
  <header>
    <div class="site-title">
        <a href="/">Zeyad Deeb</a>
    </div>  
</header>
  <div class="nav-menu">
  
    <a class="color-link nav-link" href="/about/">About</a>
  
  <a class="color-link nav-link" href="https://www.zeyaddeeb.com/index.xml" target="_blank" rel="noopener" type="application/rss+xml">RSS</a>
</div>
<footer class="footer">
	<div class="social-icons">
        

    

    

    

    

    

    

    

    

    

    
    <a class="social-icon" href="https://www.linkedin.com/in/zeyaddeeb" target="_blank" rel="noopener" title="LinkedIn">
        <svg width="28px" height="28px" viewBox="0 0 28 28" version="1.1" fill="#ABABAB" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
            <path d="M2,3.654102 C2,2.69908141 2.79442509,1.92397846 3.77383592,1.92397846 L24.2261641,1.92397846 C25.2058917,1.92397846 26,2.69908141 26,3.654102 L26,24.3462148 C26,25.3015521 25.2058917,26.0760215 24.2261641,26.0760215 L3.77383592,26.0760215 C2.79442509,26.0760215 2,25.3015521 2,24.3465315 L2,3.65378524 L2,3.654102 Z M9.27526132,22.1415901 L9.27526132,11.2356668 L5.65030092,11.2356668 L5.65030092,22.1415901 L9.27557808,22.1415901 L9.27526132,22.1415901 Z M7.46341463,9.74691162 C8.72727273,9.74691162 9.51409566,8.90940767 9.51409566,7.86284447 C9.49033893,6.79252455 8.72727273,5.97846056 7.48748812,5.97846056 C6.24675325,5.97846056 5.43649034,6.79252455 5.43649034,7.86284447 C5.43649034,8.90940767 6.22299652,9.74691162 7.4396579,9.74691162 L7.46309788,9.74691162 L7.46341463,9.74691162 Z M11.2815965,22.1415901 L14.9062401,22.1415901 L14.9062401,16.0519481 C14.9062401,15.7263225 14.9299968,15.4000634 15.0256573,15.1675641 C15.2876148,14.5159962 15.8840672,13.8416218 16.8856509,13.8416218 C18.1970225,13.8416218 18.7218879,14.8416218 18.7218879,16.3078872 L18.7218879,22.1415901 L22.3465315,22.1415901 L22.3465315,15.8885017 C22.3465315,12.5388027 20.5584416,10.9800443 18.1735825,10.9800443 C16.2182452,10.9800443 15.3595185,12.072854 14.8824834,12.8172315 L14.9065569,12.8172315 L14.9065569,11.2359835 L11.2819132,11.2359835 C11.3291099,12.2591067 11.2815965,22.1419069 11.2815965,22.1419069 L11.2815965,22.1415901 Z"></path>
        </svg>
    </a>
    

    

    

    

    

    

    

    
    
    
    <a class="social-icon" href="https://github.com/zeyaddeeb" target="_blank" rel="noopener" title="GitHub">
        <svg width="28px" height="28px" viewBox="0 0 28 28" version="1.1" fill="#ABABAB" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
            <path d="M13.9988029,1.32087331 C6.82105037,1.32087331 1,7.14112562 1,14.3212723 C1,20.0649109 4.72454649,24.9370678 9.89038951,26.6560892 C10.5408085,26.7757983 10.7778323,26.374374 10.7778323,26.0296121 C10.7778323,25.7215609 10.7666595,24.9035493 10.760275,23.8189856 C7.14426471,24.6042767 6.38131925,22.0760223 6.38131925,22.0760223 C5.78995672,20.5740732 4.93762853,20.1742451 4.93762853,20.1742451 C3.75729765,19.3682044 5.02701126,19.3841656 5.02701126,19.3841656 C6.33183953,19.4759425 7.01817121,20.7241085 7.01817121,20.7241085 C8.17775254,22.7104801 10.0611744,22.1366749 10.8017741,21.8038838 C10.919887,20.9643246 11.2558703,20.3913175 11.6269683,20.066507 C8.74038491,19.7385043 5.70536235,18.6228163 5.70536235,13.6413251 C5.70536235,12.2223743 6.21213051,11.0611968 7.04370914,10.1530044 C6.90963504,9.82420367 6.46351945,8.50181809 7.17139875,6.71256734 C7.17139875,6.71256734 8.26234691,6.36301702 10.7459099,8.04532771 C11.78259,7.75642995 12.8950858,7.61277914 14.000399,7.60719272 C15.1049142,7.61277914 16.2166119,7.75642995 17.2548881,8.04532771 C19.736855,6.36301702 20.8262071,6.71256734 20.8262071,6.71256734 C21.5356825,8.50181809 21.0895669,9.82420367 20.9562909,10.1530044 C21.7894656,11.0611968 22.2922435,12.2223743 22.2922435,13.6413251 C22.2922435,18.6355852 19.2524325,19.734514 16.3570705,20.0561322 C16.8231376,20.4575564 17.2389269,21.2508282 17.2389269,22.4638795 C17.2389269,24.2012564 17.2229657,25.603448 17.2229657,26.0296121 C17.2229657,26.3775663 17.4575954,26.7821827 18.116793,26.6552912 C23.2786458,24.9322794 27,20.0633148 27,14.3212723 C27,7.14112562 21.1789496,1.32087331 13.9988029,1.32087331"></path>
        </svg>
    </a>
    

    
    
    

    
</div>




	<script src="https://www.zeyaddeeb.com/js/main.min.fa5c2b23e07b5d9bfad267a52b4b24fdb053e6fb7524993383594926a3ac270c.js" integrity="sha256-+lwrI+B7XZv60melK0sk/bBT5vt1JJkzg1lJJqOsJww="></script>
</footer>
</nav>
        <div id="content" class="content-container">
        
<h1 class="post-title">Coronavirus (COVID-19) outbreak analysis</h1>
    <time>February 22, 2020</time>
    <div>
        <p>
        <p>The <a href="https://www.bloomberg.com/news/articles/2020-02-22/coronavirus-may-be-the-disease-x-health-agency-warned-about">first news article I read this morning</a> described Coronavirus (COVID-19) as &quot;disease X&quot;;</p>

<blockquote>
<p>The World Health Organization cautioned years ago that a mysterious “disease X” could spark an international contagion. The new coronavirus, with its ability to quickly morph from mild to deadly, is emerging as a contender - Bloomberg</p>
</blockquote>

<p>While these claims are seriously scary, I doubt they're 100% accurate. So often journalists inflate stories to sell news, and I felt like I could create an objective analysis to fact check the news. I've been working on some models surrounding COVID-19 outbreak, which I'll be sharing today.</p>

<p>John Hopkins: The Center for Systems Science and Engineering (CSSE), is kind enough to share data they collect from multiple sources. You can grab the data from this <a href="https://gisanddata.maps.arcgis.com/apps/opsdashboard/index.html#/bda7594740fd40299423467b48e9ecf6">link</a> or see my <a href="https://github.com/zeyaddeeb/coronavirus">Github</a>.</p>

<p>Obviously, the first thing to analyze is the trend of cases overtime;</p>

<div id="/plots/coronavirus-trend.html" style="display: flex;justify-content: center">
    <img src="/plots/coronavirus-trend.html" width="500vw" height="300" />
</div>

<p>This chart shows that confirmed cases are on the rise with a whopping total of 78,044 cases, with a recovery rate of 29.28% and a death rate of 3.12% as of Feb 22 2020.</p>

<p>There are two reasons why you might not get concerned about these stats.</p>

<ol>
<li>The recovery rate is higher than the death rate.</li>
<li>The majority of confirmed cases are confined to China, which is notoriously good at controlling its population, thus making quarantine easier.</li>
</ol>

<div id="/plots/coronavirus-map.html" style="display: flex;justify-content: center">
    <img src="/plots/coronavirus-map.html" width="500vw" height="300" />
</div>

<p>If you are an epidemiologist, you know that modeling of infectious diseases requires the use of Ordinary Differential Equations (ODEs) to estimate the long term impacts of the disease on a population.</p>

<p>I'll be covering the <a href="https://en.wikipedia.org/wiki/Compartmental_models_in_epidemiology#The_SIR_model">simple compartmental model (SIR)</a></p>

<p>The standard SIR equation is;</p>

<p><span  class="math">\[
S(t)+I(t)+R(t)=N
\]</span></p>

<p>which has three compartments that can be described as follows:</p>

<ul>
<li><span  class="math">\( S \)</span>: the number of individuals susceptible to the disease.</li>
<li><span  class="math">\( I \)</span>: the number of individuals infected with the disease and capable of spreading the disease to those in the susceptible group.</li>
<li><span  class="math">\( R \)</span>: the number of individuals who have been infected and then removed from the infected group, either due to recovery or due to death. Individuals in this group are not capable of contracting the disease again or transmitting the infection to others.</li>
</ul>

<p>Our free variables are <span  class="math">\(t\)</span> for time and <span  class="math">\(N\)</span> for the population.</p>

<p>There are multiple variations of the SIR model. The most basic version only accounts for the contact rate <span  class="math">\( \beta \)</span> and the recovery rate <span  class="math">\( \gamma \)</span>, python time:</p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#007020;font-weight:bold">import</span> <span style="color:#0e84b5;font-weight:bold">numpy</span> <span style="color:#007020;font-weight:bold">as</span> <span style="color:#0e84b5;font-weight:bold">np</span>
<span style="color:#007020;font-weight:bold">from</span> <span style="color:#0e84b5;font-weight:bold">scipy.integrate</span> <span style="color:#007020;font-weight:bold">import</span> odeint

N <span style="color:#666">=</span> <span style="color:#40a070">7</span>_000_000_000  <span style="color:#60a0b0;font-style:italic"># Earth population</span>
S <span style="color:#666">=</span> N <span style="color:#666">-</span> <span style="color:#40a070">1</span>  <span style="color:#60a0b0;font-style:italic"># Everybody except for patient zero</span>
I <span style="color:#666">=</span> <span style="color:#40a070">78</span>_044  <span style="color:#60a0b0;font-style:italic"># Number of infected individuals (from data)</span>
R <span style="color:#666">=</span> <span style="color:#40a070">22</span>_858  <span style="color:#60a0b0;font-style:italic"># Number of recovered individuals (from data)</span>
beta <span style="color:#666">=</span> <span style="color:#40a070">0.5</span>  <span style="color:#60a0b0;font-style:italic"># infection rate (coin toss)</span>
gamma <span style="color:#666">=</span> <span style="color:#40a070">0.14</span>  <span style="color:#60a0b0;font-style:italic"># Recovery rate (from data)</span>


<span style="color:#007020;font-weight:bold">def</span> <span style="color:#06287e">diff</span>(sir, t):
    dsdt <span style="color:#666">=</span> <span style="color:#666">-</span>(beta <span style="color:#666">*</span> sir[<span style="color:#40a070">0</span>] <span style="color:#666">*</span> sir[<span style="color:#40a070">1</span>]) <span style="color:#666">/</span> N
    didt <span style="color:#666">=</span> (beta <span style="color:#666">*</span> sir[<span style="color:#40a070">0</span>] <span style="color:#666">*</span> sir[<span style="color:#40a070">1</span>]) <span style="color:#666">/</span> N <span style="color:#666">-</span> gamma <span style="color:#666">*</span> sir[<span style="color:#40a070">1</span>]
    drdt <span style="color:#666">=</span> gamma <span style="color:#666">*</span> sir[<span style="color:#40a070">1</span>]
    dsirdt <span style="color:#666">=</span> [dsdt, didt, drdt]
    <span style="color:#007020;font-weight:bold">return</span> dsirdt


sir0 <span style="color:#666">=</span> (S, I, R)  <span style="color:#60a0b0;font-style:italic"># ODE initial conditions</span>


t <span style="color:#666">=</span> np<span style="color:#666">.</span>linspace(<span style="color:#40a070">0</span>, <span style="color:#40a070">200</span>)  <span style="color:#60a0b0;font-style:italic"># Let&#39;s solve over 200 days</span>

sir <span style="color:#666">=</span> odeint(diff, sir0, t)</code></pre></div>
<p>From this analysis we can conclude that, following this basic model, after 50 days cases of infection will start going down. According to the CDC, the <a href="https://www.cdc.gov/coronavirus/2019-ncov/summary.html">first case of coronavirus was reported Jan 30th 2020</a>.</p>

<p>Here is the plot from running the basic SIR model;</p>

<div id="/plots/coronavirus-sir.html" style="display: flex;justify-content: center">
    <img src="/plots/coronavirus-sir.html" width="500vw" height="300" />
</div>

<p>Counting 50 days past Jan 30th, it seems we will reach peak infection rate around March 15th 2020. Normal disclaimer: by no means am I claiming this is an accurate epidemic modelling (or even that it is substantial). I personally have mathematical qualms with this model because not every one in the susceptible group will be infected and the transmission rate is a latent variable.</p>

<p>Another way to model this outbreak is from a bayesian approach where we look at it from a population density perspective.</p>

<p>We can say that infection rate per country <span  class="math">\(c\)</span> as a set of Poisson random variables:</p>

<p><span  class="math">\[Pr(I_{c}(t) | \lambda_c(t)) = \text{Poisson}(\lambda_c(t)) \]</span></p>

<p>Where the country specific outbreak intensity at time <span  class="math">\(t\)</span> is modeled as:</p>

<p><span  class="math">\[\lambda_a(t) = S_c(t-1) \frac{I(t-1)\mathbf{B}}{N_c} \]</span></p>

<p>where <span  class="math">\(S_c(t-1)\)</span> is the number of susceptibles in a specific country <span  class="math">\(c\)</span> in the previous time period, and <span  class="math">\(\mathbf{B}\)</span> a matrix of transmission coefficients (<a href="https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005697#sec020">from Prem et al.</a>), and <span  class="math">\(N_c\)</span> an estimate of the population of in the country <span  class="math">\(c\)</span>.</p>

<p>This can be modeled in <code>pymc3</code> where the number of all the variables take the form of distribution and use MCMC sampling to find the actual rates. See measles reference for more detail on using the bayesian approach.</p>

<p>Remember to always be skeptical of news surrounding an outbreak, we are still in the midst of the battle. It is hard to see people lose loved ones to an outbreak, but with government intervention and adherence to basic hygiene and safety standards, the outbreak will hopefully be over soon enough.</p>

<h2 id="references">References</h2>

<p><a href="https://www.cdc.gov/coronavirus/2019-ncov/summary.html">https://www.cdc.gov/coronavirus/2019-ncov/summary.html</a>
<a href="https://lexparsimon.github.io/coronavirus/">https://lexparsimon.github.io/coronavirus/</a>
<a href="https://github.com/fonnesbeck/mongolia_measles">https://github.com/fonnesbeck/mongolia_measles</a></p>

        </p>
    </div>
    

    <div class="page-footer">
        <hr class="footer-divider">
        
    </div>


        

<link rel="stylesheet" type="text/css" href="/css/katex.min.css">
<script type="text/javascript" src="/js/katex.min.js"></script>
<script type="text/javascript" src="/js/auto-render.min.js"onload="renderMathInElement(document.body);"></script>

        </div>
        <footer class="footer-mobile">
	<div class="social-icons">
        

    

    

    

    

    

    

    

    

    

    
    <a class="social-icon" href="https://www.linkedin.com/in/zeyaddeeb" target="_blank" rel="noopener" title="LinkedIn">
        <svg width="28px" height="28px" viewBox="0 0 28 28" version="1.1" fill="#ABABAB" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
            <path d="M2,3.654102 C2,2.69908141 2.79442509,1.92397846 3.77383592,1.92397846 L24.2261641,1.92397846 C25.2058917,1.92397846 26,2.69908141 26,3.654102 L26,24.3462148 C26,25.3015521 25.2058917,26.0760215 24.2261641,26.0760215 L3.77383592,26.0760215 C2.79442509,26.0760215 2,25.3015521 2,24.3465315 L2,3.65378524 L2,3.654102 Z M9.27526132,22.1415901 L9.27526132,11.2356668 L5.65030092,11.2356668 L5.65030092,22.1415901 L9.27557808,22.1415901 L9.27526132,22.1415901 Z M7.46341463,9.74691162 C8.72727273,9.74691162 9.51409566,8.90940767 9.51409566,7.86284447 C9.49033893,6.79252455 8.72727273,5.97846056 7.48748812,5.97846056 C6.24675325,5.97846056 5.43649034,6.79252455 5.43649034,7.86284447 C5.43649034,8.90940767 6.22299652,9.74691162 7.4396579,9.74691162 L7.46309788,9.74691162 L7.46341463,9.74691162 Z M11.2815965,22.1415901 L14.9062401,22.1415901 L14.9062401,16.0519481 C14.9062401,15.7263225 14.9299968,15.4000634 15.0256573,15.1675641 C15.2876148,14.5159962 15.8840672,13.8416218 16.8856509,13.8416218 C18.1970225,13.8416218 18.7218879,14.8416218 18.7218879,16.3078872 L18.7218879,22.1415901 L22.3465315,22.1415901 L22.3465315,15.8885017 C22.3465315,12.5388027 20.5584416,10.9800443 18.1735825,10.9800443 C16.2182452,10.9800443 15.3595185,12.072854 14.8824834,12.8172315 L14.9065569,12.8172315 L14.9065569,11.2359835 L11.2819132,11.2359835 C11.3291099,12.2591067 11.2815965,22.1419069 11.2815965,22.1419069 L11.2815965,22.1415901 Z"></path>
        </svg>
    </a>
    

    

    

    

    

    

    

    
    
    
    <a class="social-icon" href="https://github.com/zeyaddeeb" target="_blank" rel="noopener" title="GitHub">
        <svg width="28px" height="28px" viewBox="0 0 28 28" version="1.1" fill="#ABABAB" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
            <path d="M13.9988029,1.32087331 C6.82105037,1.32087331 1,7.14112562 1,14.3212723 C1,20.0649109 4.72454649,24.9370678 9.89038951,26.6560892 C10.5408085,26.7757983 10.7778323,26.374374 10.7778323,26.0296121 C10.7778323,25.7215609 10.7666595,24.9035493 10.760275,23.8189856 C7.14426471,24.6042767 6.38131925,22.0760223 6.38131925,22.0760223 C5.78995672,20.5740732 4.93762853,20.1742451 4.93762853,20.1742451 C3.75729765,19.3682044 5.02701126,19.3841656 5.02701126,19.3841656 C6.33183953,19.4759425 7.01817121,20.7241085 7.01817121,20.7241085 C8.17775254,22.7104801 10.0611744,22.1366749 10.8017741,21.8038838 C10.919887,20.9643246 11.2558703,20.3913175 11.6269683,20.066507 C8.74038491,19.7385043 5.70536235,18.6228163 5.70536235,13.6413251 C5.70536235,12.2223743 6.21213051,11.0611968 7.04370914,10.1530044 C6.90963504,9.82420367 6.46351945,8.50181809 7.17139875,6.71256734 C7.17139875,6.71256734 8.26234691,6.36301702 10.7459099,8.04532771 C11.78259,7.75642995 12.8950858,7.61277914 14.000399,7.60719272 C15.1049142,7.61277914 16.2166119,7.75642995 17.2548881,8.04532771 C19.736855,6.36301702 20.8262071,6.71256734 20.8262071,6.71256734 C21.5356825,8.50181809 21.0895669,9.82420367 20.9562909,10.1530044 C21.7894656,11.0611968 22.2922435,12.2223743 22.2922435,13.6413251 C22.2922435,18.6355852 19.2524325,19.734514 16.3570705,20.0561322 C16.8231376,20.4575564 17.2389269,21.2508282 17.2389269,22.4638795 C17.2389269,24.2012564 17.2229657,25.603448 17.2229657,26.0296121 C17.2229657,26.3775663 17.4575954,26.7821827 18.116793,26.6552912 C23.2786458,24.9322794 27,20.0633148 27,14.3212723 C27,7.14112562 21.1789496,1.32087331 13.9988029,1.32087331"></path>
        </svg>
    </a>
    

    
    
    

    
</div>





	<script src="https://www.zeyaddeeb.com/js/main.min.fa5c2b23e07b5d9bfad267a52b4b24fdb053e6fb7524993383594926a3ac270c.js" integrity="sha256-+lwrI+B7XZv60melK0sk/bBT5vt1JJkzg1lJJqOsJww="></script>
</footer>
    </body>
</html>